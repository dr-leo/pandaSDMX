language: python
os: linux
dist: bionic

jobs:
  include:
  # Linux jobs
  - python: 3.7.3  # earliest
  - python: 3.7
  - python: 3.8
  # Non-linux jobs; Python configured below
  - os: osx
    - : python: 3.8
    # Homebrew installs Python to this location
    # env: PATH=/usr/local/opt/python@3.8/bin:$PATH
  - os: windows
    language: shell
    # Chocolatey installs Python to this location
    env: PATH=/c/Python38:/c/Python38/Scripts:$PATH


install:
# Install Python & pip on macOS and Windows
- |-
  case $TRAVIS_OS_NAME in
    # osx)
    #  brew update --quiet
    #  brew install python@3.8 ;;
    windows)
      choco install --no-progress python3
  esac
# All platforms
- pip3 install --requirement requirements.txt
- pip3 install .[cache,doc,test]

script: >
  pytest
  -ra
  --verbose
  -m "not experimental"
  --cov pandasdmx --cov-report term-missing

after_success:
- coverage combine
- codecov

notifications:
  email: false
